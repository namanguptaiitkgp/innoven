{% extends "base_generic.html" %}

{% block content %}
<div class="row">
    <div class="col-sm-3"></div>
    <div class="col-sm-6"><center><h2> Pipeline  </h2> </center></div>
    <div class="col-sm-3" ><center> <h4 class="btn btn-primary">  <a href="{% url 'project_create' %}" style="color: white"> Add</a></h4></center></div>
 </div>
  {% if project_list %}
   <div class="row">
    <div class="col-sm-3"></div>
    <div class="col-sm-6 card">
     <ul class="list-group list-group-flush">
      {% for project in project_list %}

      <li class="list-group-item">
       <h4><a href="{{ project.get_absolute_url }}">{{ project.name }}</a></h4>
         Deal Stage: {{project.dealstage}} | Loan Amount: {{ project.loan_Amount }} <br> Director: {{project.director.name}} | Underwriter Name: {% for member in project.member.all %} {{ member }}{% if not forloop.last %}, {% endif %} {% endfor %}
      </li>

    {% endfor %}
    </ul>
</div>
</div>
  {% else %}
    <p>There are no projects in the Company.</p>
  {% endif %}
<table class="table">
  <thead>
    <tr>
      <th scope="col">Name</th>
      <th scope="col">Deal Stage</th>
      <th scope="col">Members</th>
      <th scope="col">Amount</th>
      <th scope="col">Investors</th>
      <th scope="col">Next Step</th>
    </tr>
  </thead>
  <tbody>
  {% for project in project_list %}
       {% if project.dealstage.name == "Prospect"  %}
    <tr>
      <td>{{ project.name }}</td>
      <td>{{ project.dealstage }}</td>
      <td>{% for member in project.member.all %} {{ member }}, {% endfor %} {{ project.director }}</td>
      <td>{{ project.loan_Amount }}</td>
      <td> {% for investor in project.investor.all %} {{ investor }}{% if not forloop.last %}, {% endif %}{% endfor %} {% if project.if_other_investor %} {{ project.if_other_investor }} {% endif %}</td>
      <td>{{ project.next_step }}</td>
    </tr>
       {% endif %}
  {% endfor %}
   {% for project in project_list %}
       {% if project.dealstage.name == "Underwriting Stage"  %}
    <tr>
      <td>{{ project.name }}</td>
      <td>{{ project.dealstage }}</td>
      <td>{% for member in project.member.all %} {{ member }}, {% endfor %} {{ project.director }}</td>
      <td>{{ project.loan_Amount }}</td>
      <td> {% for investor in project.investor.all %} {{ investor }}{% if not forloop.last %}, {% endif %}{% endfor %} {% if project.if_other_investor %} {{ project.if_other_investor }} {% endif %}</td>
      <td>{{ project.next_step }}</td>
    </tr>
       {% endif %}
  {% endfor %}
   {% for project in project_list %}
       {% if project.dealstage.name == "TS Issued"  %}
    <tr>
      <td>{{ project.name }}</td>
      <td>{{ project.dealstage }}</td>
      <td>{% for member in project.member.all %} {{ member }}, {% endfor %} {{ project.director }}</td>
      <td>{{ project.loan_Amount }}</td>
      <td> {% for investor in project.investor.all %} {{ investor }}{% if not forloop.last %}, {% endif %}{% endfor %} {% if project.if_other_investor %} {{ project.if_other_investor }} {% endif %}</td>
      <td>{{ project.next_step }}</td>
    </tr>
       {% endif %}
  {% endfor %}
   {% for project in project_list %}
       {% if project.dealstage.name == "TS Closure"  %}
    <tr>
      <td>{{ project.name }}</td>
      <td>{{ project.dealstage }}</td>
      <td>{% for member in project.member.all %} {{ member }}, {% endfor %} {{ project.director }}</td>
      <td>{{ project.loan_Amount }}</td>
      <td> {% for investor in project.investor.all %} {{ investor }}{% if not forloop.last %}, {% endif %}{% endfor %} {% if project.if_other_investor %} {{ project.if_other_investor }} {% endif %}</td>
      <td>{{ project.next_step }}</td>
    </tr>
       {% endif %}
  {% endfor %}
   {% for project in project_list %}
       {% if project.dealstage.name == "Documentation"  %}
    <tr>
      <td>{{ project.name }}</td>
      <td>{{ project.dealstage }}</td>
      <td>{% for member in project.member.all %} {{ member }}, {% endfor %} {{ project.director }}</td>
      <td>{{ project.loan_Amount }}</td>
      <td> {% for investor in project.investor.all %} {{ investor }}{% if not forloop.last %}, {% endif %}{% endfor %} {% if project.if_other_investor %} {{ project.if_other_investor }} {% endif %}</td>
      <td>{{ project.next_step }}</td>
    </tr>
       {% endif %}
  {% endfor %}

  </tbody>
</table>

{% endblock %}